<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="sale_order_form_inherit_ntp_invoice_slicing" model="ir.ui.view">
        <field name="name">sale.order.view.form.inherit.ntp.invoice.slicing</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <field name="company_group_code" invisible="1" />
                <field name="so_to_sliced_invoice_configurable" invisible="1" />
                <page name="slicing" string="Invoice Slicing" attrs="{'invisible': [('so_to_sliced_invoice_configurable', '=', False)]}">
                    <group string="Slicing Configuration">
                        <field name="so_to_sliced_invoice_enable" />
                        <field name="so_to_sliced_invoice_start_date" required="1" />
                        <field name="sub_ids" widget="many2many_tags" readonly="1" string="Sub List" />
                    </group>
                    <field name="so_to_sliced_invoices_ids"
                           widget="many2many"
                           attrs="{'invisible': [('so_to_sliced_invoice_enable', '=', False)]}"
                           domain="[('company_group_code', '=', company_group_code), ('sale_order_id', '=', active_id)]"
                           context="{'default_partner_id': partner_id, 'default_sale_order_id': active_id}">
                        <tree editable="bottom">
                            <field name="sequence" widget="handle" />
                            <field name="partner_id" optional="hide" />
                            <field name="company_group_code" optional="hide" />
                            <field name="member_id" />
                            <field name="tax_code" />
                            <field name="quota_to_invoice" />
                            <field name="quota_unit" />
                            <field name="max_total_amount_per_invoice" />
                        </tree>
                    </field>
                    <button string="Copy Default Slicing Invoice" name="button_copy_default_slicing_config"
                            type="object" class="oe_highlight"
                            attrs="{'invisible': [('so_to_sliced_invoice_configurable', '=', False)]}"  />
                </page>
            </xpath>
        </field>
    </record>

</odoo>
